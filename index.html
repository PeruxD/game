<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Juego Básico con Sprites</title>
    <style>
        canvas {
            border: 1px solid black;
        }
    </style>
</head>
<body>
    <canvas id="gameCanvas" width="800" height="600"></canvas>
    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');

        // Cargar imágenes desde URLs externas
        const playerImg = new Image();
        playerImg.src = 'https://opengameart.org/sites/default/files/knight_stand.png'; // Caballero
        const enemyImg = new Image();
        enemyImg.src = 'https://opengameart.org/sites/default/files/slime_green.png'; // Monstruo
        const grassTile = new Image();
        grassTile.src = 'https://opengameart.org/sites/default/files/grass_0.png'; // Césped
        const stoneTile = new Image();
        stoneTile.src = 'https://opengameart.org/sites/default/files/stone_1.png'; // Piedra

        // Objeto del jugador
        const player = {
            x: 50,
            y: 50,
            width: 32,
            height: 32,
            speed: 5
        };

        // Objeto del enemigo
        const enemy = {
            x: 400,
            y: 300,
            width: 32,
            height: 32,
            speed: 2
        };

        // Mapa basado en tiles (0 = césped, 1 = piedra)
        const tileSize = 32;
        const map = [
            [0, 0, 0, 0, 1, 1, 0, 0, 0, 0],
            [0, 1, 0, 0, 0, 1, 0, 0, 1, 0],
            [0, 0, 0, 1, 0, 0, 0, 1, 0, 0],
            [1, 0, 0, 0, 0, 1, 0, 0, 0, 1],
            [0, 0, 1, 0, 0, 0, 0, 1, 0, 0]
        ];

        // Controles de movimiento
        const keys = {
            ArrowUp: false,
            ArrowDown: false,
            ArrowLeft: false,
            ArrowRight: false
        };

        document.addEventListener('keydown', (e) => {
            if (e.key in keys) keys[e.key] = true;
        });
        document.addEventListener('keyup', (e) => {
            if (e.key in keys) keys[e.key] = false;
        });

        // Actualizar estado del juego
        function update() {
            if (keys.ArrowUp && player.y > 0) player.y -= player.speed;
            if (keys.ArrowDown && player.y < canvas.height - player.height) player.y += player.speed;
            if (keys.ArrowLeft && player.x > 0) player.x -= player.speed;
            if (keys.ArrowRight && player.x < canvas.width - player.width) player.x += player.speed;

            // Movimiento simple del enemigo hacia el jugador
            if (enemy.x < player.x) enemy.x += enemy.speed;
            if (enemy.x > player.x) enemy.x -= enemy.speed;
            if (enemy.y < player.y) enemy.y += enemy.speed;
            if (enemy.y > player.y) enemy.y -= enemy.speed;
        }

        // Dibujar el mapa
        function drawMap() {
            for (let row = 0; row < map.length; row++) {
                for (let col = 0; col < map[0].length; col++) {
                    const tileX = col * tileSize;
                    const tileY = row * tileSize;
                    if (map[row][col] === 0) {
                        ctx.drawImage(grassTile, tileX, tileY, tileSize, tileSize);
                    } else if (map[row][col] === 1) {
                        ctx.drawImage(stoneTile, tileX, tileY, tileSize, tileSize);
                    }
                }
            }
        }

        // Dibujar todo
        function draw() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            drawMap();
            ctx.drawImage(playerImg, player.x, player.y, player.width, player.height);
            ctx.drawImage(enemyImg, enemy.x, enemy.y, enemy.width, enemy.height);
        }

        // Bucle del juego
        function gameLoop() {
            update();
            draw();
            requestAnimationFrame(gameLoop);
        }

        // Esperar a que las imágenes carguen antes de empezar
        let imagesLoaded = 0;
        const totalImages = 4;
        function imageLoaded() {
            imagesLoaded++;
            if (imagesLoaded === totalImages) {
                gameLoop();
            }
        }

        playerImg.onload = imageLoaded;
        enemyImg.onload = imageLoaded;
        grassTile.onload = imageLoaded;
        stoneTile.onload = imageLoaded;

        // Manejar errores de carga de imágenes
        playerImg.onerror = () => console.error('Error cargando knight.png');
        enemyImg.onerror = () => console.error('Error cargando monster.png');
        grassTile.onerror = () => console.error('Error cargando grass.png');
        stoneTile.onerror = () => console.error('Error cargando stone.png');
    </script>
</body>
</html>
